const mostrarAlerta=(e,r,o,t)=>{Swal.fire({title:e,text:r,icon:o,timer:1500,timerProgressBar:!0,showConfirmButton:!1,iconColor:t,customClass:{title:"swal-title"},buttonsStyling:!1})},convertirCodigo=(e,r=!0)=>{const o=/<\?php|<\?=|\?>/g;if(o.test(e))return mostrarAlerta("Error","El código ya está en PHP y no puede convertirse nuevamente.","error","#FF5733"),"";const t=/[^a-zA-Z0-9\s\(\)\{\}\[\]\=\+\-\*\%\!\&\|\<\>\.\,\;\:]/g;if(t.test(e))return mostrarAlerta("Error","Por favor, ingresa un código de JavaScript válido.","error","#FF5733"),!1;const a=/\$\w+/g;if(a.test(e)&&r)return mostrarAlerta("Error","No se puede convertir. El código contiene variables o estructuras de PHP.","error","#FF5733"),"";const n=/\b(if|for|while|switch|function|return|else|try|catch|break|continue|let|var|const)\b/g;if(!n.test(e))return mostrarAlerta("Error","Por favor, ingresa un código JavaScript válido con estructuras de control.","error","#FF5733"),"";const i=[{expresionRegular:/\b(let|const|var)\b/g,reemplazo:"$"},{expresionRegular:/\bconsole\.log\(/g,reemplazo:"echo "},{expresionRegular:/\bfunction\s+(\w+)/g,reemplazo:"function $1"},{expresionRegular:/\bfor\s*\((.*?)\)/g,reemplazo:"foreach ($1)"},{expresionRegular:/\b===\b/g,reemplazo:"=="},{expresionRegular:/\b!==\b/g,reemplazo:"!="},{expresionRegular:/\btrue\b/g,reemplazo:"true"},{expresionRegular:/\bfalse\b/g,reemplazo:"false"},{expresionRegular:/\bnull\b/g,reemplazo:"null"},{expresionRegular:/\belse if\b/g,reemplazo:"elseif"}],s=r?i:conversionesPHPaJavaScript;let l=s.reduce((e,r)=>e.replace(r.expresionRegular,r.reemplazo),e);return r&&(l=`<?php\n${l}\n?>`),l},validarCodigo=e=>{const r=/\b(let|const|var)\s+[^\s;]+[^;]*$/g,o=/\[.*[^\]]/g;return r.test(e)?(mostrarAlerta("Error","Por favor, asegúrate de definir las variables correctamente (debe terminar con un punto y coma).","error","#FF5733"),!1):!o.test(e)||(mostrarAlerta("Error","Asegúrate de que los arrays estén correctamente formados y cerrados.","error","#FF5733"),!1)},procesarCodigo=()=>{const e=document.getElementById("entradaJS").value.trim();e?validarCodigo(e)&&Swal.fire({title:"¿Estás seguro?",text:"¿Quieres realizar la conversión a PHP?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, convertir",cancelButtonText:"No, cancelar",confirmButtonColor:"#28A745",cancelButtonColor:"#FF5733",iconColor:"#007BFF"}).then(r=>{if(r.isConfirmed){const r=convertirCodigo(e);r&&(document.getElementById("salidaPHP").value=r,mostrarAlerta("Conversión exitosa","Código convertido a PHP.","success","#28A745"))}}):mostrarAlerta("Error","Por favor ingresa código en el campo.","error","#FF5733")},copiarAlPortapapeles=()=>{const e=document.getElementById("salidaPHP").value.trim();e?Swal.fire({title:"¿Estás seguro?",text:"¿Quieres copiar el código convertido?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, copiar",cancelButtonText:"No, cancelar",confirmButtonColor:"#28A745",cancelButtonColor:"#FF5733",iconColor:"#007BFF"}).then(r=>{r.isConfirmed&&navigator.clipboard.writeText(e).then(()=>mostrarAlerta("¡Copiado!","El código ha sido copiado al portapapeles.","success","#28A745")).catch(()=>mostrarAlerta("Error","Hubo un problema al copiar el código.","error","#FF5733"))}):mostrarAlerta("Error","No hay código para copiar.","error","#FF5733")},limpiarCampos=()=>{Swal.fire({title:"¿Estás seguro?",text:"¿Deseas limpiar todas las conversiones?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, limpiar",cancelButtonText:"No, cancelar",confirmButtonColor:"#28A745",cancelButtonColor:"#FF5733",iconColor:"#007BFF"}).then(e=>{e.isConfirmed&&(document.getElementById("entradaJS").value="",document.getElementById("salidaPHP").value="",mostrarAlerta("Limpieza exitosa","Todos los campos han sido limpiados.","success","#28A745"))})};document.getElementById("btnGenerar").addEventListener("click",procesarCodigo),document.getElementById("btnCopiar").addEventListener("click",copiarAlPortapapeles),document.getElementById("btnLimpiar").addEventListener("click",limpiarCampos);